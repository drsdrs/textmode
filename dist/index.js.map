{
  "version": 3,
  "file": "index.js",
  "sourceRoot": "",
  "sources": [
    "index.src.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "# requestAnimationFrame polyfill by Erik MÃ¶ller. fixes from Paul Irish and Tino Zijdel\n# MIT license\n\ndo ->\n  lastTime = 0\n  vendors = [ 'ms', 'moz', 'webkit', 'o' ]\n  x = 0\n  while x < vendors.length and !window.requestAnimationFrame\n    window.requestAnimationFrame = window[vendors[x] + 'RequestAnimationFrame']\n    window.cancelAnimationFrame = window[vendors[x] + 'CancelAnimationFrame'] or window[vendors[x] + 'CancelRequestAnimationFrame']\n    ++x\n  if !window.requestAnimationFrame\n\n    window.requestAnimationFrame = (callback, element) ->\n      currTime = (new Date).getTime()\n      timeToCall = Math.max(0, 16 - (currTime - lastTime))\n      id = window.setTimeout((->\n        callback currTime + timeToCall\n        return\n      ), timeToCall)\n      lastTime = currTime + timeToCall\n      id\n\n  if !window.cancelAnimationFrame\n\n    window.cancelAnimationFrame = (id) ->\n      clearTimeout id\n      return\n  return\n\ninit = ->\n  screenEl = document.getElementById 'textmode_screen'\n  screenWrapEl = document.getElementById 'textmode_wrap'\n  styleHoverChar = document.createElement(\"style\")\n  styleBackgroundSize = document.createElement(\"style\")\n\n\n  tm = new Textmode screenEl\n\n\n\n  iconPos = 0\n  fontSize = 25\n  activeCharCode = String.fromCharCode 0xe0a9\n  activeLiEl = null\n  mouseWheelHandler = (e)->\n    e = window.event || e\n    delta = Math.max(-1, Math.min(1, (e.wheelDelta || -e.detail)))\n    iconPos += delta\n    iconPos = if iconPos<0 then 95 else if iconPos>94 then 0 else iconPos\n    charCodeString = \"e0\"+(0xa0+iconPos).toString(16)\n    activeCharCode = String.fromCharCode parseInt(charCodeString, 16)\n    setIcon()\n\n\n  setIcon = ()->\n    styleHoverChar.innerHTML =\n      '#textmode_screen ul li:hover::before {\\n\n        content: \"'+activeCharCode+'\";\\n\n        font-size: '+fontSize+'px;\\n\n      }'\n\n\n  centerScreenFunct = -> centerScreen screenWrapEl, screenEl\n\n  centerScreen = (parent, child)->\n    parent.height = window.innerHeight\n    paddingLeft = (parent.offsetWidth - child.offsetWidth)/2\n    paddingTop = (parent.height - child.offsetHeight)/2\n    if paddingTop<5||paddingLeft<5\n      return -1\n    else if (paddingTop > child.offsetHeight/5) && (paddingLeft > child.offsetWidth/5)\n      return 1\n    else\n      parent.style.padding = paddingTop+'px '+paddingLeft+'px'\n      return 0\n\n  getStyle = (className) ->\n    classes = document.styleSheets[0].rules or document.styleSheets[0].cssRules\n    x = 0\n    while x < classes.length\n      if classes[x].selectorText == className\n        return classes[x].style\n      x++\n\n\n  window.addEventListener 'resize', ->\n    centerScreenFunct()\n    adjustFont()\n    setIcon()\n\n  screenEl.addEventListener 'mouseover', (e)->\n    if e.target.tagName.toLowerCase()=='li'\n      activeLiEl = e.target\n\n  screenEl.addEventListener 'mousewheel', mouseWheelHandler\n\n  screenEl.addEventListener 'contextmenu', (e)->\n    e.preventDefault()\n    activeCharCode = activeLiEl.innerHTML\n    if activeCharCode==\"&nbsp;\" then activeCharCode = String.fromCharCode 0xa0\n    setIcon()\n    false\n\n  screenEl.addEventListener 'click', ->\n    if activeLiEl? then activeLiEl.innerHTML = activeCharCode\n\n  resizeFont = (amount)->\n    fontSize += amount\n    screenEl.style.fontSize = (fontSize+amount)+'px'\n    styleBackgroundSize.innerHTML = '#textmode_wrap::after { background-size: '+(fontSize*0.175)+'px }'\n\n  adjustFont = ()->\n    resizeRes = centerScreenFunct()\n    cnt = 0\n    while resizeRes!=0\n      resizeRes = centerScreenFunct()\n      resizeFont resizeRes\n      cnt++\n      if (cnt++)>120 then resizeRes = 0;alert 'problem detected in adjustFont Function'\n    resizeFont(0)\n    centerScreenFunct()\n\n  adjustFont()\n  setIcon()\n\n\n  document.head.appendChild styleHoverChar\n  document.head.appendChild styleBackgroundSize\n\nwindow.onload = init\n\nclass Textmode\n  constructor: (textEl)->\n    @el = textEl\n    @initScreen()\n    @welcomeMsg()\n    window.addEventListener 'keydown', @keydown\n    window.addEventListener 'keypress', @keypress\n    requestAnimationFrame @cycle\n  SCREENSIZE: w:40, h:25\n  time: 0 # count every animation frame\n  cursor: x:0, y:0, blink:true\n  keydown: (e)=>\n    if e.keyCode==8 # BACKSPACE\n      e.preventDefault()\n      @delChar()\n      return false\n    if e.ctrlKey && e.shiftKey then @switchCaps()\n    else if e.keyCode==37 then @checkCursor @cursor.x-1, null # LEFT ARROW\n    else if e.keyCode==39 then @checkCursor @cursor.x+1, null # RIGHT ARROW\n    else if e.keyCode==40 then @checkCursor null, @cursor.y+1 # TOP ARROW\n    else if e.keyCode==38 then @checkCursor null, @cursor.y-1 # BOTTOM ARROW\n  keypress: (e)=>\n    if e.keyCode==13 then @getLine() # ENTER\n    else if (e.keyCode||e.charCode)==32 then @putChar '&nbsp;' # SPACE\n    else\n      charCode = if e.keyCode==0 then e.charCode else e.keyCode\n      @putChar String.fromCharCode charCode\n  switchCaps: ->\n    @el.className = if @el.className!='capsMode' then 'capsMode' else ''\n  welcomeMsg: ->\n    @checkCursor(0, 0)\n    @writeDelayed '\\n     **** saylermorph.com v0.1 ****\\n\\n 64k ram system 38911 basic bytes free\\n\\nready.\\n'\n  initScreen: ->\n    for y in [0...@SCREENSIZE.h]\n      rowEl = document.createElement 'ul'\n      for x in [0...@SCREENSIZE.w]\n        cellEl = document.createElement 'li'\n        cellEl.innerHTML = '&nbsp;'\n        rowEl.appendChild cellEl\n      @el.appendChild rowEl\n\n  checkCursor: (x,y)->\n    @getCell().className = ''\n    @cursor.x = x if x?\n    @cursor.y = y if y?\n\n    if @cursor.x==@SCREENSIZE.w\n      @cursor.x = 0\n      @cursor.y++\n    else if @cursor.x==-1\n      @cursor.x = @SCREENSIZE.w-1\n      @cursor.y--\n\n    if @cursor.y==@SCREENSIZE.h\n      @cursor.y -= 1\n      @shiftScreenUp()\n\n    else if @cursor.y==-1\n      @cursor.y = @SCREENSIZE.h-1\n\n    @getCell().className = 'inverted'\n\n  cmdInterpreter: (cmd)->\n    interval = null\n    if cmd.trim().length==0 then return true\n    if cmd.split('clear').length>1\n      @clearScreen()\n    else if cmd.split('list').length>1\n      @writeDelayed '0\\n1\\n2\\n3\\n4\\n5\\nready.\\n'\n    else if cmd.split('reset').length>1\n      @clearScreen()\n      @welcomeMsg()\n    else if cmd.split('help').length>1\n      @writeDelayed '\\n\\ncall 0900-drs-will-do-it\\nready.\\n'\n    else if cmd.split('load').length>1\n      @writeDelayed '\\n\\npress play on tape\\nloading\\nready.\\n'\n    else if cmd.split('run').length>1\n      @clearScreen()\n      @writeDelayed '\n        1. A robot may not injure a human being\\n   or, through inaction, allow a human\n        \\n   being to come to harm.\n        \\n\\n2. A robot must obey the orders given\n        \\n   it by human beings except where such\\n   orders would conflict with the First\\n   Law.\n        \\n\\n3. A robot must protect its own\n        \\n   existence as long as such protection\\n   does not conflict with\\n   the First or Second Laws\n        \\n\\n\\n\\nready.\\n'\n    else @writeDelayed '\\n?syntax error\\nready.\\n'\n    return true\n\n\n  getCell: ->\n    @el.childNodes[@cursor.y].childNodes[@cursor.x]\n\n  getLine: ->\n    lineText = ''\n    for child in @el.childNodes[@cursor.y].childNodes\n      char = child.innerHTML\n      lineText += if char=='&nbsp;' then ' ' else char\n    if @cmdInterpreter lineText.toLowerCase() then @newLine()\n    @checkCursor()\n\n  blinkCursor: ->\n    if @cursor.blink then @getCell().className = 'inverted'\n    else @getCell().className = ''\n    @cursor.blink = !@cursor.blink\n\n  putChar: (char)->\n    @checkCursor null, null\n    @getCell().innerHTML = char\n    @checkCursor @cursor.x+1, null\n\n  delChar: ()->\n    @checkCursor @cursor.x-1, null\n    cell = @getCell()\n    cell.innerHTML = '&nbsp;'\n\n  newLine: ()=>\n    @checkCursor 0, @cursor.y+1\n    @getCell().className = 'inverted'\n\n  clearScreen: ->\n    @getCell().className = ''\n    @cursor = x:0, y:0, blink:false\n    for line in @el.childNodes\n      for cell in line.childNodes\n        cell.innerHTML = '&nbsp;'\n    @getCell().className = 'inverted'\n\n  setColor: ->  null # TODO ???\n\n  shiftScreenUp: ->\n    len = @el.childNodes\n    for child, i in @el.childNodes\n      if i==@el.childNodes.length-1\n        for li in child.childNodes\n          li.innerHTML = \"&nbsp\"\n        return true\n      replacement = @el.childNodes[i+1].innerHTML\n      original = @el.childNodes[i]\n      original.innerHTML = replacement\n\n      #replacement.parentNode.replaceChild replacement, original\n\n\n  textToWriteDelayed: \"\"\n\n  writeDelayed: (text)-> @textToWriteDelayed += text\n\n  nextDelayedText: ()->\n    @write @textToWriteDelayed[0]\n    @textToWriteDelayed = @textToWriteDelayed.substring 1, @textToWriteDelayed.length\n\n  write: (text)-> # TODO implement \\0 - \\f \\! codes \\fore /background foreground and inverted\n    for char in text\n      if char=='\\n' then @newLine()\n      else\n        @putChar if char==' ' then char = '&nbsp;' else char\n\n  cycle: =>\n    if (@time++)%35==0 then @blinkCursor()\n    if (@time)%1==0 && @textToWriteDelayed.length>0 then @nextDelayedText()\n    requestAnimationFrame @cycle\n"
  ]
}